<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fit the mediation slope model: effect of A on B — fitSlope • mrlocus</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fit the mediation slope model: effect of A on B — fitSlope"><meta property="og:description" content="Implements the MRLocus slope fitting step, in which the estimated
coefficients and their original SE are used to determine
the mediation slope (alpha), and the dispersion of individual
signal clusters around the slope (sigma). This function
follows the colocalization step fitBetaColoc
and extractForSlope.
The output fitSlope can be visualized with
plotMrlocus. For details on the model,
see Supplementary Methods of the MRLocus manuscript.
See vignette for example of model interpretation."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mrlocus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.25</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/thelovelab/mrlocus/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit the mediation slope model: effect of A on B</h1>
    <small class="dont-index">Source: <a href="https://github.com/thelovelab/mrlocus/blob/HEAD/R/mrlocus.R" class="external-link"><code>R/mrlocus.R</code></a></small>
    <div class="hidden name"><code>fitSlope.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Implements the MRLocus slope fitting step, in which the estimated
coefficients and their original SE are used to determine
the mediation slope (<code>alpha</code>), and the dispersion of individual
signal clusters around the slope (<code>sigma</code>). This function
follows the colocalization step <code><a href="fitBetaColoc.html">fitBetaColoc</a></code>
and <code><a href="extractForSlope.html">extractForSlope</a></code>.
The output <code>fitSlope</code> can be visualized with
<code><a href="plotMrlocus.html">plotMrlocus</a></code>. For details on the model,
see Supplementary Methods of the MRLocus manuscript.
See vignette for example of model interpretation.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fitSlope</span><span class="op">(</span></span>
<span>  <span class="va">res</span>,</span>
<span>  sd_beta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mu_alpha <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sd_alpha <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sd_sigma <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>res</dt>
<dd><p>list with the following named elements:</p><ul><li><p><code>beta_hat_a</code> - point estimates of coefficients for A from colocalization</p></li>
<li><p><code>beta_hat_b</code> - " " for B</p></li>
<li><p><code>sd_a</code> - sampling SD for <code>beta_hat_a</code> (in practice original
SE are provided here)</p></li>
<li><p><code>sd_b</code> - " " for <code>beta_hat_b</code> " "</p></li>
<li><p>alleles (optional) data.frame with allele information</p></li>
</ul></dd>


<dt>sd_beta</dt>
<dd><p>prior SD for beta A (default value will be derived from data)</p></dd>


<dt>mu_alpha</dt>
<dd><p>prior mean for <code>alpha</code> (default value will be derived from data)</p></dd>


<dt>sd_alpha</dt>
<dd><p>prior SD for <code>alpha</code> (default value will be derived from data)</p></dd>


<dt>sd_sigma</dt>
<dd><p>prior SD for <code>sigma</code> (default value of 1)</p></dd>


<dt>...</dt>
<dd><p>further arguments passed to <code><a href="https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html" class="external-link">rstan::sampling</a></code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>list with the following elements: <code>stanfit</code> object,
original estimated coefficients and standard deviations,
as well as the <code>alleles</code> data.frame (if it was provided)</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Note that if summary statistics for only one SNP are provided
a warning will be printed (this is not a recommended use
of MRLocus) and a parametric simulation is used to estimate the
slope, instead of the Bayesian model.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Anqi Zhu*, Nana Matoba*, Emma P. Wilson, Amanda L. Tapia, Yun Li,
Joseph G. Ibrahim, Jason L. Stein, Michael I. Love.
MRLocus: identifying causal genes mediating a trait through
Bayesian estimation of allelic heterogeneity. (2021) PLOS Genetics
<a href="https://doi.org/10.1371/journal.pgen.1009455" class="external-link">https://doi.org/10.1371/journal.pgen.1009455</a></p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Anqi Zhu, Nana Matoba, Jason Stein, Michael Love.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

